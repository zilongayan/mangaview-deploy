"use strict";exports.id=555,exports.ids=[555],exports.modules={11906:(a,b,c)=>{c.d(b,{l8:()=>n,JM:()=>s,u_:()=>p,Z3:()=>r,xD:()=>o,Ds:()=>q});let d="https://api.mangadex.org";function e(){if(process.env.NEXT_PUBLIC_SITE_URL)return process.env.NEXT_PUBLIC_SITE_URL;if(process.env.VERCEL_URL)return`https://${process.env.VERCEL_URL}`;let a=process.env.PORT||"3000";return`http://localhost:${a}`}function f(a,b){let c=new URL(a.startsWith("/")?`${e()}${a}`:a);return Object.entries(b).forEach(([a,b])=>{Array.isArray(b)?b.forEach(b=>c.searchParams.append(a,b)):"object"==typeof b&&null!==b?Object.entries(b).forEach(([b,d])=>{null!=d&&c.searchParams.set(`${a}[${b}]`,String(d))}):null!=b&&c.searchParams.set(a,String(b))}),c.toString()}async function g(a){try{let b=a.startsWith("/")?`${e()}${a}`:a,c=await fetch(b,{headers:{Accept:"application/json","User-Agent":"MangaView/1.0"},next:{revalidate:300}});if(!c.ok)throw Error(`HTTP error! status: ${c.status}`);return await c.json()}catch(b){throw console.error(`Failed to fetch from ${a}:`,b),b}}async function h({limit:a=24,offset:b=0,order:c,title:e,includedTags:h=[],availableTranslatedLanguage:i=["en","fr"],contentRating:j=["safe","suggestive","erotica","pornographic"],includes:k=["cover_art"]}){let l=f(`${d}/manga`,{limit:a,offset:b,title:e,"includedTags[]":h,"availableTranslatedLanguage[]":i,"contentRating[]":j,"includes[]":k,order:c});return await g(l)}async function i(a,b=["cover_art"]){let c=f(`${d}/manga/${a}`,{"includes[]":b});return(await g(c)).data}async function j(a=["cover_art"]){try{let b=f(`${d}/manga/random`,{"includes[]":a});return(await g(b)).data}catch{let b=await h({limit:50,order:{latestUploadedChapter:"desc"},includes:a});return b.data[Math.floor(Math.random()*b.data.length)]}}async function k(a,{limit:b=100,offset:c=0,translatedLanguage:e=["en","fr","es","it","pt-br","ru","de","id","vi"],order:h={chapter:"desc",readableAt:"desc"},includeExternalUrl:i=0,includeEmptyPages:j=0,includeFuturePublishAt:k=0}){try{let l=f(`${d}/manga/${a}/feed`,{limit:b,offset:c,"translatedLanguage[]":e,"includes[]":["scanlation_group"],includeExternalUrl:i,includeEmptyPages:j,includeFuturePublishAt:k,order:h});console.log(`Fetching manga feed from: ${l}`);let m=await g(l);if(console.log("Manga feed response:",{total:m.total,limit:m.limit,offset:m.offset,chaptersCount:m.data.length}),m.data&&m.data.length>0)return m;console.log("No chapters found with specific languages, trying without language restriction");let n=f(`${d}/manga/${a}/feed`,{limit:b,offset:c,"includes[]":["scanlation_group"],includeExternalUrl:i,includeEmptyPages:j,includeFuturePublishAt:k,order:h}),o=await g(n);if(console.log("Manga feed response (no language restriction):",{total:o.total,limit:o.limit,offset:o.offset,chaptersCount:o.data.length}),o.data&&o.data.length>0)return o;console.log("Trying alternative approach: get manga with all includes");try{let b=await g(`${d}/manga/${a}?includes[]=cover_art&includes[]=author&includes[]=artist&includes[]=chapter&includes[]=scanlation_group`);if(b.data&&b.data.relationships){let c=b.data.relationships.filter(a=>"chapter"===a.type);if(console.log(`Found ${c.length} chapter relationships in manga data`),c.length>0){let b=c.map(a=>a.id);console.log(`Trying to fetch details for ${b.length} chapters`);let e=f(`${d}/chapter`,{"manga[]":a,limit:100,offset:0,"includes[]":["scanlation_group"],order:{chapter:"desc"}}),h=await g(e);if(console.log("Direct chapters fetch response:",{total:h.total,chaptersCount:h.data.length}),h.data&&h.data.length>0)return h}}}catch(a){console.error("Alternative approach failed:",a)}console.log("Trying final approach: get chapters without any restrictions");try{let b=f(`${d}/chapter`,{"manga[]":a,limit:100,offset:0,"includes[]":["scanlation_group","manga"],"order[chapter]":"desc","order[volume]":"desc"});console.log(`Final chapters URL: ${b}`);let c=await g(b);if(console.log("Final chapters fetch response:",{total:c.total,chaptersCount:c.data.length}),c.data&&c.data.length>0)return c}catch(a){console.error("Final approach failed:",a)}throw Error("No chapters found with any approach")}catch(e){console.error(`Failed to fetch manga feed for ${a}:`,e);try{console.log(`Trying alternative endpoint for manga ${a}`);let e=await g(`${d}/manga/${a}?includes[]=chapter`);if(e.data&&e.data.relationships){let a=e.data.relationships.filter(a=>"chapter"===a.type);return console.log(`Found ${a.length} chapter relationships in manga data`),{result:"ok",response:"collection",data:[],total:0,limit:b,offset:c}}throw Error("No chapter data found in manga")}catch(d){return console.error(`Fallback also failed for manga ${a}:`,d),{result:"ok",response:"collection",data:[],total:0,limit:b,offset:c}}}}async function l(a,b=!0){try{let c=`${d}/at-home/server/${a}`,{baseUrl:e,chapter:f}=await g(c),h=b?f.dataSaver:f.data,i=b?"data-saver":"data";return h.map(a=>`${e}/${i}/${f.hash}/${a}`)}catch(b){console.error(`Failed to fetch chapter pages for ${a}:`,b);try{let b=(await g(`${d}/chapter/${a}`)).data.attributes.pages||6;return Array.from({length:b},(a,b)=>`placeholder://page-${b+1}`)}catch(b){throw console.error(`Fallback also failed for ${a}:`,b),Error("Unable to load chapter pages. Please try again later.")}}}function m(a){let b=function(a){let b=a?.find(a=>"cover_art"===a.type);return b?.attributes?.fileName}(a.relationships);return{id:a.id,title:function(a){let b=a.attributes.title;return b.en||b["ja-ro"]||Object.values(b)[0]||"Untitled"}(a),cover:function(a,b,c=512){return b?`https://uploads.mangadex.org/covers/${a}/${b}.${c}.jpg`:null}(a.id,b,512)||"/icon-192.png",tags:(a.attributes.tags||[]).map(a=>a.attributes?.name?.en||Object.values(a.attributes?.name||{})[0]).filter(Boolean),description:function(a,b=["fr","en","ja-ro"]){let c=a.attributes.description||{};for(let a of b)if(c[a])return c[a];let d=Object.values(c)[0];return("string"==typeof d?d:"")||""}(a)}}async function n({page:a,pageSize:b=24}){let c=(a-1)*b,d=await h({limit:b,offset:c,order:{latestUploadedChapter:"desc"}}),e=await h({limit:b,offset:c,order:{followedCount:"desc"}});return{recent:d.data.map(m),popular:e.data.map(m),total:d.total,popularTotal:e.total}}async function o(){return m(await j(["cover_art"]))}async function p(a){try{let b=await i(a,["cover_art"]);return m(b)}catch{return null}}async function q({query:a="",tags:b="",artists:c="",page:d=1}){let e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,f=b?b.split(",").map(a=>a.trim()).filter(a=>e.test(a)):[];return(await h({limit:24,offset:(d-1)*24,title:a||void 0,includedTags:f.length?f:void 0,order:a?void 0:{latestUploadedChapter:"desc"}})).data.map(m)}async function r(a,b=100){try{console.log(`Fetching chapters for manga ${a} with limit ${b}`);let c=await k(a,{limit:b,order:{chapter:"desc"},includeExternalUrl:0,includeEmptyPages:0,includeFuturePublishAt:0});if(console.log(`Feed response for manga ${a}:`,{total:c.total,chaptersCount:c.data.length,result:c.result}),!c.data||0===c.data.length)return console.log(`No chapters found for manga ${a}`),[];let d=c.data.map(a=>({id:a.id,number:a.attributes.chapter||"-",title:a.attributes.title||"",language:a.attributes.translatedLanguage,pages:a.attributes.pages,readableAt:a.attributes.readableAt,groups:(a.relationships||[]).filter(a=>"scanlation_group"===a.type).map(a=>a.attributes?.name||"").filter(Boolean)}));return console.log(`Processed ${d.length} chapters for manga ${a}`),d}catch(b){return console.error(`Error fetching chapters for manga ${a}:`,b),[]}}async function s(a,b=!0){return l(a,b)}},84292:(a,b,c)=>{c.d(b,{FavoriteButtonCompact:()=>g,Z:()=>f});var d=c(60687),e=c(43210);function f({itemId:a,initialIsFavorite:b=!1,className:c=""}){let[f,g]=(0,e.useState)(b),[h,i]=(0,e.useState)(!1),j=async()=>{i(!0);try{let b=await fetch("/api/favorites",{method:f?"DELETE":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemId:a})});if(b.ok)g(!f),f?console.log("Retir\xe9 des favoris !"):console.log("Ajout\xe9 aux favoris !");else{let a=await b.json();401===b.status?window.location.href="/login":console.error("Erreur:",a.error)}}catch(a){console.error("Erreur r\xe9seau:",a)}finally{i(!1)}};return(0,d.jsxs)("button",{onClick:j,disabled:h,className:`group relative flex items-center justify-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed ${c}`,title:f?"Retirer des favoris":"Ajouter aux favoris",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("svg",{className:`w-5 h-5 transition-all duration-300 ${f?"text-red-500 scale-110":"text-gray-400 dark:text-gray-500 group-hover:text-red-400 group-hover:scale-110"}`,fill:f?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2*!f,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),h&&(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,d.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin opacity-60"})})]}),(0,d.jsx)("span",{className:`text-sm transition-colors ${f?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 group-hover:text-red-500"}`,children:f?"Favori":"Ajouter aux favoris"}),f&&(0,d.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:(0,d.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-2",children:(0,d.jsx)("div",{className:"text-red-500 text-xs animate-ping",children:"\uD83D\uDC96"})})})]})}function g({itemId:a,initialIsFavorite:b=!1}){let[c,f]=(0,e.useState)(b),[g,h]=(0,e.useState)(!1),i=async()=>{h(!0);try{let b=await fetch("/api/favorites",{method:c?"DELETE":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemId:a})});b.ok?f(!c):401===b.status&&(window.location.href="/login")}catch(a){console.error("Erreur:",a)}finally{h(!1)}};return(0,d.jsx)("button",{onClick:i,disabled:g,className:`p-2 rounded-full transition-all duration-300 hover:scale-110 disabled:opacity-50 ${c?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-white/80 text-gray-500 hover:bg-red-50 hover:text-red-500 dark:bg-slate-800/80 dark:text-gray-400 dark:hover:bg-red-900/20"}`,title:c?"Retirer des favoris":"Ajouter aux favoris",children:(0,d.jsx)("svg",{className:"w-4 h-4",fill:c?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2*!c,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})}},86964:(a,b,c)=>{c.d(b,{NavBar:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call NavBar() from the server but NavBar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/andranikhakobyan/Desktop/dossier sans titre 2/n5/portal/src/components/NavBar.tsx","NavBar")},90392:(a,b,c)=>{c.d(b,{AgeGate:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call AgeGate() from the server but AgeGate is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/andranikhakobyan/Desktop/dossier sans titre 2/n5/portal/src/components/AgeGate.tsx","AgeGate")}};